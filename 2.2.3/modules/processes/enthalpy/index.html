
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Run your own glacier simulations in a fast, accurate, and user-friendly way.">
      
      
      
        <link rel="canonical" href="https://jouvetg.github.io/igm-doc.github.io/2.2.3/modules/processes/enthalpy/">
      
      
        <link rel="prev" href="../clim_oggm/">
      
      
        <link rel="next" href="../gflex/">
      
      
      <link rel="icon" href="../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.30">
    
    
      
        <title>enthalpy - Instructed Glacier Model (IGM)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="glacier_light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#enthalpy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Instructed Glacier Model (IGM)" class="md-header__button md-logo" aria-label="Instructed Glacier Model (IGM)" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Instructed Glacier Model (IGM)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              enthalpy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="glacier_light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="glacier_dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jouvetg/igm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jouvetg/igm
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../installation/quick_start/" class="md-tabs__link">
          
  
  Installation

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../hydra/introduction/" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../introduction/" class="md-tabs__link">
          
  
  Modules

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../about/gpus/" class="md-tabs__link">
          
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Instructed Glacier Model (IGM)" class="md-nav__button md-logo" aria-label="Instructed Glacier Model (IGM)" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    Instructed Glacier Model (IGM)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jouvetg/igm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jouvetg/igm
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/quick_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/other/nvidia_drivers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nvidia Drivers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/other/virtual_environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Environments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/other/wsl_windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WSL Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Using Hydra
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Using Hydra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hydra/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hydra/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hydra/distributed_computing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Computing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/quick_demo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Demo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/aletsch_basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aletsch Basic
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What are modules?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Input
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Input
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../inputs/load_ncdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    load_ncdf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../inputs/load_tif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    load_tif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../inputs/oggm_shop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    oggm_shop
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Processes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Processes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avalanche/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    avalanche
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clim_oggm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clim_oggm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    enthalpy
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    enthalpy
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#config-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Config Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#theory" class="md-nav__link">
    <span class="md-ellipsis">
      Theory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ice-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Ice flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enthalpy_1" class="md-nav__link">
    <span class="md-ellipsis">
      Enthalpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basal-melt" class="md-nav__link">
    <span class="md-ellipsis">
      Basal melt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#water-thickness" class="md-nav__link">
    <span class="md-ellipsis">
      Water thickness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sliding-parametrization" class="md-nav__link">
    <span class="md-ellipsis">
      Sliding parametrization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ahrrenius-factor" class="md-nav__link">
    <span class="md-ellipsis">
      Ahrrenius factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pressure-adujsuted-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      Pressure-adujsuted temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numerical-scheme" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numerical-stability-time-stepping" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical stability -- time stepping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gflex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gflex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glerosion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    glerosion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iceflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iceflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../particles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    particles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../print_info.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    print_info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../read_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    read_output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rockflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rockflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smb_accpdd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smb_accpdd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smb_oggm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smb_oggm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smb_simple/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    smb_simple
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../texture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    texture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    thk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vert_flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vert_flow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Output
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Output
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/write_ncdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_ncdf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/write_particles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_particles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/write_tif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_tif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/write_ts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_ts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outputs/plot2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot2d
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/custom_modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/gpus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphical Processing Units (GPUs)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/tensorflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensorflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/credits_and_references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crediting IGM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variables
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="enthalpy">enthalpy</h1>
<p>This IGM module models the ice enthalpy, which permits to jointly model the ice temperature, as well as the water content created when the temperature hits the pressure melting points, and therefore energy conservation, which is not the case when modelling the sole temperature variable. The model is described in <a href="https://www.cambridge.org/core/journals/journal-of-glaciology/article/an-enthalpy-formulation-for-glaciers-and-ice-sheets/605D2EC3DE03B82F2A8289220E76EB27">(Aschwanden and al, JOG, 2012)</a>. Here, we used a simplified version largely inspired from the one implemented in <a href="https://www.pism.io/">PISM</a>. Other references that have helped are <a href="https://tc.copernicus.org/articles/9/217/2015/">(Kleiner and al, TC, 2015)</a> and <a href="https://www.sciencedirect.com/science/article/abs/pii/S0098300419311458">(Wang and al, 2020)</a>.</p>
<h2 id="config-structure">Config Structure</h2>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">enthalpy</span><span class="p">:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">water_density</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000.0</span><span class="w"> </span><span class="c1"># help=&quot;Constant of the Water density [kg m-3]&quot;,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="nt">spy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">31556926.0</span><span class="w"> </span><span class="c1"># help=&quot;Number of seconds per years [s y-1]&quot;,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">ki</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.1</span><span class="w"> </span><span class="c1"># help=&quot;Conductivity of cold ice [W m-1 K-1] (Aschwanden and al, JOG, 2012)&quot;,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">  </span><span class="nt">ci</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2009.0</span><span class="w"> </span><span class="c1"># help=&quot;Specific heat capacity of ice [W s kg-1 K-1] (Aschwanden and al, JOG, 2012)&quot;,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">  </span><span class="nt">Lh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.34e+5</span><span class="w"> </span><span class="c1"># help=&quot;latent heat of fusion [W s kg-1] = [E] (Aschwanden and al, JOG, 2012)&quot;,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">  </span><span class="nt">KtdivKc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1e-1</span><span class="w"> </span><span class="c1"># help=&quot;Ratio of temp vs cold ice diffusivity Kt / Kc [no unit] (Aschwanden and al, JOG, 2012)&quot;,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">  </span><span class="nt">claus_clape</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7.9e-8</span><span class="w"> </span><span class="c1"># help=&quot;Clausius-Clapeyron constant [K Pa-1] (Aschwanden and al, JOG, 2012)&quot;,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">  </span><span class="nt">melt_temp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">273.15</span><span class="w"> </span><span class="c1"># help=&quot;Melting point at standart pressure [K] (Aschwanden and al, JOG, 2012)&quot;,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">  </span><span class="nt">ref_temp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">223.15</span><span class="w"> </span><span class="c1"># help=&quot;Reference temperature [K] (Aschwanden and al, JOG, 2012)&quot;,</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">  </span><span class="nt">till_friction_angle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30.0</span><span class="w"> </span><span class="c1"># help=&quot;Till friction angle in the Mohr-Coulomb friction law [deg]&quot;,</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">  </span><span class="nt">till_friction_angle_bed_min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w"> </span><span class="c1"># help=&quot;till_friction_angle_bed_min&quot;,</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">  </span><span class="nt">till_friction_angle_bed_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w"> </span><span class="c1"># help=&quot;till_friction_angle_bed_max&quot;,</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">  </span><span class="nt">till_friction_angle_phi_min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15.0</span><span class="w"> </span><span class="c1"># help=&quot;till_friction_angle_phi_min&quot;,</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">  </span><span class="nt">till_friction_angle_phi_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">45.0</span><span class="w"> </span><span class="c1"># help=&quot;till_friction_angle_phi_max&quot;,</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">  </span><span class="nt">uthreshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100.0</span><span class="w"> </span><span class="c1"># help=&quot;uthreshold [m/y] # &quot;--uthreshold&quot;, type=float, default=100, help=&quot;uthreshold [m/y]&quot;</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">  </span><span class="nt">drain_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span><span class="w"> </span><span class="c1"># help=&quot;Drain rate at 1 mm/y  [m y-1] (Bueler and Pelt, GMD, 2015)&quot;,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">  </span><span class="nt">till_wat_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.0</span><span class="w"> </span><span class="c1"># help=&quot;Maximum water till tickness [m] (Bueler and Pelt, GMD, 2015)&quot;,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">  </span><span class="nt">drain_ice_column</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"> </span><span class="c1"># help=&quot;Transform the water content beyond a thr=0.01 into water, drain it, and add it to basal melt rate&quot;,</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">  </span><span class="nt">default_bheatflx</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.065</span><span class="w"> </span><span class="c1"># help=&quot;Geothermal heat flux [W m-2]&quot;,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">  </span><span class="nt">temperature_offset_air_to_ice</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span><span class="w"> </span><span class="c1"># help=&quot;This is the offset between the air temperature and the ice temperature as records show [e.g., Reeh 1991] shows that the mean temperature at the ice surface is about XÂ°C colder than the temperature of ice to be given as boundary upper condition to the Enthlapy model&quot;,</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">  </span><span class="nt">tauc_min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e+5</span><span class="w"> </span><span class="c1"># help=&quot;lower bound for tauc [Pa]&quot;</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">  </span><span class="nt">tauc_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e+10</span><span class="w"> </span><span class="c1"># help=&quot;lower bound for tauc [Pa]&quot;</span>
</span></code></pre></div>
<h2 id="parameters">Parameters</h2>
<table>
  <thead>
    <tr>
      <th>Name</th>

      <th>Type</th>

      <th>Units</th>

      <th>Description</th>

      <th>Default Value</th>
    </tr>
  </thead>
  <tbody>

    <tr>
      <td>water_density</td>
      <td>float</td>
      <td><span class="math">$$kg~m^{-3}$$</span></td>
      <td>Constant of the Water density</td>

      <td>1000.0</td>
    </tr>

    <tr>
      <td>spy</td>
      <td>float</td>
      <td><span class="math">$$s y^{-1}$$</span></td>
      <td>Number of seconds per years</td>

      <td>31556926.0</td>
    </tr>

    <tr>
      <td>ki</td>
      <td>float</td>
      <td><span class="math">$$W~m^{-1}~K^{-1}$$</span></td>
      <td>Conductivity of cold ice (Aschwanden and al, JOG, 2012)</td>

      <td>2.1</td>
    </tr>

    <tr>
      <td>ci</td>
      <td>float</td>
      <td><span class="math">$$W~s~kg^{-1}~K^{-1}$$</span></td>
      <td>Specific heat capacity of ice (Aschwanden and al, JOG, 2012)</td>

      <td>2009.0</td>
    </tr>

    <tr>
      <td>Lh</td>
      <td>float</td>
      <td><span class="math">$$W~s~kg^{-1} = E$$</span></td>
      <td>Latent heat of fusion (Aschwanden and al, JOG, 2012)</td>

      <td>334000.0</td>
    </tr>

    <tr>
      <td>KtdivKc</td>
      <td>float</td>
      <td><span class="math">$$\frac{Kt}{Kc}$$ [dimensionaless]</span></td>
      <td>Ratio of temp vs cold ice diffusivity (Aschwanden and al, JOG, 2012)</td>

      <td>1e-1</td>
    </tr>

    <tr>
      <td>claus_clape</td>
      <td>float</td>
      <td><span class="math">$$K~Pa^{-1}$$</span></td>
      <td>Clausius-Clapeyron constant (Aschwanden and al, JOG, 2012)</td>

      <td>7.9e-08</td>
    </tr>

    <tr>
      <td>melt_temp</td>
      <td>float</td>
      <td><span class="math">$$K$$</span></td>
      <td>Melting point at standard pressure (Aschwanden and al, JOG, 2012)</td>

      <td>273.15</td>
    </tr>

    <tr>
      <td>ref_temp</td>
      <td>float</td>
      <td><span class="math">$$K$$</span></td>
      <td>Reference temperature (Aschwanden and al, JOG, 2012)</td>

      <td>223.15</td>
    </tr>

    <tr>
      <td>till_friction_angle</td>
      <td>float</td>
      <td><span class="math">$$\circ$$</span></td>
      <td>Till friction angle in the Mohr-Coulomb friction law</td>

      <td>30.0</td>
    </tr>

    <tr>
      <td>till_friction_angle_bed_min</td>
      <td>float</td>
      <td><span class="math">$$\circ$$</span></td>
      <td>Minimum till friction angle at the bed</td>

      <td>None</td>
    </tr>

    <tr>
      <td>till_friction_angle_bed_max</td>
      <td>float</td>
      <td><span class="math">$$\circ$$</span></td>
      <td>Maximum till friction angle at the bed</td>

      <td>None</td>
    </tr>

    <tr>
      <td>till_friction_angle_phi_min</td>
      <td>float</td>
      <td><span class="math">$$\circ$$</span></td>
      <td>Minimum till friction angle phi</td>

      <td>15.0</td>
    </tr>

    <tr>
      <td>till_friction_angle_phi_max</td>
      <td>float</td>
      <td><span class="math">$$\circ$$</span></td>
      <td>Maximum till friction angle phi</td>

      <td>45.0</td>
    </tr>

    <tr>
      <td>uthreshold</td>
      <td>float</td>
      <td><span class="math">$$\frac{m}{y}$$</span></td>
      <td>Threshold velocity</td>

      <td>100.0</td>
    </tr>

    <tr>
      <td>drain_rate</td>
      <td>float</td>
      <td><span class="math">$$\frac{m}{y}$$</span></td>
      <td>Drain rate at 1 mm/y (Bueler and Pelt, GMD, 2015)</td>

      <td>0.001</td>
    </tr>

    <tr>
      <td>till_wat_max</td>
      <td>float</td>
      <td><span class="math">$$m$$</span></td>
      <td>Maximum water till thickness (Bueler and Pelt, GMD, 2015)</td>

      <td>2.0</td>
    </tr>

    <tr>
      <td>drain_ice_column</td>
      <td>float</td>
      <td><span class="math">$$m$$</span></td>
      <td>Transform the water content beyond a threshold into water, drain it, and add it to basal melt rate</td>

      <td>True</td>
    </tr>

    <tr>
      <td>default_bheatflx</td>
      <td>float</td>
      <td><span class="math">$$W~m^{-2}$$</span></td>
      <td>Geothermal heat flux</td>

      <td>0.065</td>
    </tr>

    <tr>
      <td>temperature_offset_air_to_ice</td>
      <td>float</td>
      <td><span class="math">$$K$$</span></td>
      <td>Offset between the air temperature and the ice temperature</td>

      <td>0.0</td>
    </tr>

    <tr>
      <td>tauc_min</td>
      <td>float</td>
      <td><span class="math">$$Pa$$</span></td>
      <td>Lower bound for tauc</td>

      <td>100000.0</td>
    </tr>

    <tr>
      <td>tauc_max</td>
      <td>float</td>
      <td><span class="math">$$Pa$$</span></td>
      <td>Upper bound for tauc</td>

      <td>10000000000.0</td>
    </tr>

  </tbody>
</table>

<script type="text/javascript">
  MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
</script>

<h2 id="example-usage">Example Usage</h2>
<h2 id="theory">Theory</h2>
<h3 id="ice-flow">Ice flow</h3>
<p>Here we only quickly sketch the components of the ice dynamical modelling necessary for modeling the Enthalpy.</p>
<p>Ice is assumed to be a Non Newtonian fluid, gouverned by Glen's flow law:</p>
<div class="arithmatex">\[ \tau = A^{-1/n} | D({\bf u}) |^{1/n-1} D({\bf u}), \]</div>
<p>where <span class="arithmatex">\(D({\bf U})\)</span> and <span class="arithmatex">\(\tau\)</span> are the strain rate and deviatoric stress tensor, respectively. While a no-stress condition is applied on the top surface, we assume that
the basal shear stress  <span class="arithmatex">\(\tau_b\)</span> and the sliding velocity <span class="arithmatex">\(u_b\)</span> are linked by Weertmann power law at the glacier bed interface:</p>
<div class="arithmatex">\[
 \tau_b = - c | u_b |^{m-1} u_b,
\]</div>
<p>where <span class="arithmatex">\(c=\tau_c u_{th}^{-m}\)</span> (unit: <span class="arithmatex">\(Mpa \; m^{-m} \; y^m\)</span>), <span class="arithmatex">\(\tau_c\)</span> being the yield stress and <span class="arithmatex">\(u_{th}\)</span> being a parameter homegenous to ice velocity. This formalism is taken from PISM.</p>
<p>(Note that originally, IGM had <span class="arithmatex">\(c^{-m}\)</span> instead of <span class="arithmatex">\(c\)</span> above as "slidingco" with <span class="arithmatex">\(u_{th}=1\)</span>. The newest runs under parameters "new_sliding_param", and <span class="arithmatex">\(c\)</span> has unit <span class="arithmatex">\(MPa \; m^{-m} \; y^m\)</span>)</p>
<h3 id="enthalpy_1">Enthalpy</h3>
<p>The Enthalpy <span class="arithmatex">\(E\)</span> is a 3D variable defined everywhere in the ice as a function of the temperature <span class="arithmatex">\(T\)</span> and the water content <span class="arithmatex">\(\omega\)</span>:</p>
<div class="arithmatex">\[
\begin{align}
E(T, \omega,p) = 
\left\{
\begin{array}{ll}
c_i (T- T_{\rm ref}), &amp; {\rm  if } \; T &lt; T_{\rm pmp} , \\ 
E_{\rm pmp} + L \omega, &amp;  
{\rm if } \;  T = T_{\rm pmp} \; {\rm and } \; 0 \le \omega,
\end{array} 
\right.  
\end{align}
\]</div>
<p>where <span class="arithmatex">\(c_i\)</span> is the heat capacity, <span class="arithmatex">\(T_{ref}\)</span> is the reference temperature, <span class="arithmatex">\(T_{\rm pmp} = T_{\rm pmp}(p) = T_0 - \beta p\)</span> is the temperature pressure-melting point of ice, <span class="arithmatex">\(E_{\rm pmp}(p)\)</span>  is the enthalpy pressure-melting point of ice defined as </p>
<div class="arithmatex">\[ E_{\rm pmp}(p) = c_i (T_{\rm pmp}(p) - T_{\rm ref}), \]</div>
<p>where <span class="arithmatex">\(L\)</span> is the latent heat of fusion. According to the above defintion of enthalpy, we have two possible modes: i) the ice is cold, i.e. below the melting point, and the Enthalpy is simply proportional to the temperature minus a reference temperature ii) the ice is temperate and the Enthalpy continue to grow, the additional component <span class="arithmatex">\(L \omega\)</span> corresponding to the creation of water content by energy transfer. Therefore, it is straightforward to deduce <span class="arithmatex">\(E\)</span> from <span class="arithmatex">\(T\)</span> and <span class="arithmatex">\(\omega\)</span>.</p>
<p>The enthalpy model consists of the following advection-diffusion equation (the horizontal diffusion being neglected):</p>
<div class="arithmatex">\[ 
\begin{align}
&amp; \rho_i \left( \frac{\partial E}{ \partial t}
+ u_x \frac{\partial E}{ \partial x}
+ u_y \frac{\partial E}{ \partial y} 
+ u_z \frac{\partial E}{ \partial z} \right) 
 - \frac{\partial }{\partial z} \left(
K_{c,t} \frac{\partial E}{ \partial z} \right)
= \phi - \rho_w L D_w(\omega),
\end{align}
\]</div>
<p>where <span class="arithmatex">\(\rho_i\)</span> is the ice density, <span class="arithmatex">\(K_{c,t}\)</span> equals <span class="arithmatex">\(K_c = k_i/c_i\)</span> if the ice is cold (<span class="arithmatex">\(E&lt;E_{pmp}\)</span>) or <span class="arithmatex">\(K_t = \epsilon k_i/c_i\)</span> otherwise, <span class="arithmatex">\(\phi\)</span> is the strain heating defined by (using Glen's flow law)</p>
<div class="arithmatex">\[ \phi = D({\bf U}) \tau = A^{-1/n} | D({\bf u}) |^{1+1/n}, \]</div>
<p>where <span class="arithmatex">\(D({\bf U})\)</span> and <span class="arithmatex">\(\tau\)</span> are the strain rate and deviatoric stress tensor, respectively. The last source term <span class="arithmatex">\(- \rho_w L D_w(\omega)\)</span>  permits to remove the water in temperate ice <span class="arithmatex">\(D_w(\omega)\)</span> being a drainage function ((Greve, 1997) and (Aschwanden et al., 2012)).</p>
<p>At the top ice surface, the enthalpy equation is constrained by the surface temperature (or equivalently the Enthalpy) provided by the climate forcing (Dirichlet condition). At the glacier bed, boundary conditions for the enthalpy equation are multiple (<a href="https://www.cambridge.org/core/journals/journal-of-glaciology/article/an-enthalpy-formulation-for-glaciers-and-ice-sheets/605D2EC3DE03B82F2A8289220E76EB27">(Aschwanden and al, JOG, 2012)</a>, <a href="https://tc.copernicus.org/articles/9/217/2015/">(Kleiner and al, TC, 2015)</a> and <a href="https://www.sciencedirect.com/science/article/abs/pii/S0098300419311458">(Wang and al, 2020)</a>.)</p>
<ul>
<li><span class="arithmatex">\(K_{c} \frac{\partial E}{ \partial z} = Q_{\rm geo} + Q_{\rm fh}\)</span> if <span class="arithmatex">\(E_b&lt;E_{\rm pmp}\)</span> and <span class="arithmatex">\(H_w = 0\)</span>, (cold base, dry) </li>
<li><span class="arithmatex">\(E_b = E_{\rm pmp}\)</span> if <span class="arithmatex">\(E_b&lt;E_{\rm pmp}\)</span> and <span class="arithmatex">\(H_w &gt; 0\)</span>, (cold base, wet)</li>
<li><span class="arithmatex">\(E_b = E_{\rm pmp}\)</span> if <span class="arithmatex">\(E_b \ge E_{\rm pmp}\)</span> and <span class="arithmatex">\(W_{till}&gt; 0\)</span>, zero temperate basal layer, (temperate base, cold ice)</li>
<li><span class="arithmatex">\(K_{t} \frac{\partial E}{ \partial z} = 0\)</span> if <span class="arithmatex">\(E_b \ge E_{\rm pmp}\)</span> and <span class="arithmatex">\(W_{till} &gt; 0\)</span>, non-zero temperate basal layer, (temperate base, temp. ice)</li>
</ul>
<p>where <span class="arithmatex">\(H_t\)</span> is the height of the temperate basal layer, <span class="arithmatex">\(Q_{\rm geo}\)</span> and <span class="arithmatex">\(Q_{\rm fh}\)</span> are the geothermal heat flux, and the frictional heat flux, respectively. The latter is defined by </p>
<div class="arithmatex">\[ 
Q_{\rm fh} = \tau_b \cdot u_b = c | u_b |^{m+1}.
\]</div>
<p>As a matter of fact, the ice enthalpy (or equivalently temperature and water content) feedbacks the dynamical model in two ways. The Enthalpy directly impacts the sliding basal parametrization, while variations in temperature and water content cause ice softening or hardening. </p>
<h3 id="basal-melt">Basal melt</h3>
<p>When the temperature hits the pressure-melting point at the glacier bed (i.e. <span class="arithmatex">\(E \ge E_{\rm pmp}\)</span>), the basal melt rate is calculated via the following equation:</p>
<div class="arithmatex">\[
\begin{equation}
m_b = \frac{Q_{fr}+Q_{geo} - K_{t,c} \frac{\partial E}{ \partial z} }{\rho_i L}. 
\end{equation}
\]</div>
<p>The basal melt rate is further adjusted positively to account for the drainage of the water content generated along the entire column.</p>
<h3 id="water-thickness">Water thickness</h3>
<p>The basal water thickness in the till <span class="arithmatex">\(W_{till}\)</span> is computed directly from the basal melt rate as follows:</p>
<div class="arithmatex">\[
\begin{equation}
\frac{\partial W_{till} }{ \partial z} = \frac{m_b}{\rho_w} - C,
\end{equation}
\]</div>
<p>where <span class="arithmatex">\(C\)</span> is a simple drainage parameter. The till is assumed to be saturated when it reaches the value <span class="arithmatex">\(W_{till}^{max} = 2\)</span> m, therefore, the till water thickness is bounded to this value. The effective thickness of water within the till <span class="arithmatex">\(N_{till}\)</span> is computed from the saturation ratio <span class="arithmatex">\(s= W_{till} / W_{till}^{max}\)</span> by the formula <a href="https://gmd.copernicus.org/articles/8/1613/2015/gmd-8-1613-2015.html">(Bueler and Pelt, GMD, 2015)</a>:</p>
<div class="arithmatex">\[
\begin{equation}
N_{till} = \min \left\{ P_0, N_0 \left( \frac{\delta P_0}{N_0} \right)^s 10^{(e_0/C_c)(1-s)} \right\},
\end{equation}
\]</div>
<p>where <span class="arithmatex">\(P_0\)</span> is the ice overburden pressure and the remaining parameters are constant. </p>
<h3 id="sliding-parametrization">Sliding parametrization</h3>
<p>Last, the sliding coefficient <span class="arithmatex">\(c\)</span> is defined with the Mohr-Coulomb (Cuffey and Paterson, 2010) sliding law with the effective pressure in the till:</p>
<div class="arithmatex">\[
\begin{align}
c  = \tau_c u_{th}^{-m} &amp; = N_{till} \tan(\phi) u_{th}^{-m}, \\
\end{align}
\]</div>
<p>where <span class="arithmatex">\(\phi\)</span> is the till friction angle.</p>
<h3 id="ahrrenius-factor">Ahrrenius factor</h3>
<p>We use the Glen-Paterson-Budd-Lliboutry-Duval law, where</p>
<div class="arithmatex">\[A(T,\omega)= A_c(T)(1+C \omega) \]</div>
<p>where <span class="arithmatex">\(A_c(T)\)</span> is given by the Paterson-Budd law:</p>
<div class="arithmatex">\[  A_c(T)= A \exp{( âQ / (R \, T_{pa}) )} \]</div>
<p>where <span class="arithmatex">\(A\)</span> and <span class="arithmatex">\(Q\)</span> have different values below and above a threshold temperature. </p>
<div class="arithmatex">\[ A = 3.985 \times 10^{-13} \, s^{-1} Pa^{-3}, \textrm{ if } T &lt;263.15 K\]</div>
<div class="arithmatex">\[ A = 1.916 \times 10^3 \, s^{-1} Pa^{-3}, \textrm{else.}\]</div>
<p>and</p>
<div class="arithmatex">\[ Q =  60 kJ mol^{-1},  \textrm{ if } T &lt;263.15 K\]</div>
<div class="arithmatex">\[ Q = 139 kJ mol^{-1},  \textrm{else.}\]</div>
<p>These values are taken from (Paterson 1994).</p>
<h3 id="pressure-adujsuted-temperature">Pressure-adujsuted temperature</h3>
<p>Melting point temperature at pressure is adjusted for pressure as follows</p>
<div class="arithmatex">\[ T_{pmp} = T_{0} - \beta \rho g d, \]</div>
<p>where <span class="arithmatex">\(d\)</span> is the depth, <span class="arithmatex">\(T_{0}=273.15\)</span> is the melting temperate at standart pressure (unit [<span class="arithmatex">\(K\)</span>]),  <span class="arithmatex">\(\beta = 7.9 \; 10^{-8}\)</span> is Clausius-Clapeyron constant (unit [<span class="arithmatex">\(K Pa^{-1}\)</span>]). Therefore, one define the "pressure-adjusted" temperaure <span class="arithmatex">\(T_{pa}\)</span> as being the temperature with a shift such that its metling point temperature reference is always zero:</p>
<div class="arithmatex">\[ T_{pa} = T + \beta \rho g z. \]</div>
<h3 id="numerical-scheme">Numerical scheme</h3>
<p>To solve the Enthalpy equation numerically, one makes use of the same horizontal and vertical discretization as used for the ice flow.
Treating the horizontal advection term explicitly using an upwind scheme, the Enthalpy equation with its boundary conditions can be solved column-wise as a one-dimensional advection-diffusion equation. This is achieved implicitly for both the vertical advection and the diffusion term, which are approximated by finite differences. For each column, 
one solves a small tridiagonal using the Tridiagonal Matrix Algorithm (TDMA) aka Thomas Algorithm.</p>
<p>Updating the Enthalpy at time <span class="arithmatex">\(t^{n+1}\)</span> requires to perform several sub-steps (in function ''update_enthalpy(params,state)''):</p>
<ul>
<li>compute the mean surface temperature <span class="arithmatex">\(T^n_s\)</span> to enforce upper surface Dirichlet Boundary condition,</li>
<li>compute the vertical discretization with respect to the ice geometry <span class="arithmatex">\(h^n\)</span>,</li>
<li>compute the temperature <span class="arithmatex">\(T_{pmp}\)</span> and enthalpy <span class="arithmatex">\(E_{pmp}\)</span> at pressure meltinf point,</li>
<li>compute the ice temperature field <span class="arithmatex">\(T^n\)</span> from the Enthalpy <span class="arithmatex">\(E^n\)</span>,</li>
<li>compute the Arrhenius factor <span class="arithmatex">\(A(T^n)\)</span> from temperature <span class="arithmatex">\(T^n\)</span>,</li>
<li>compute the 3D strain heat <span class="arithmatex">\(\phi^n\)</span> from ice flow field <span class="arithmatex">\({\bf u}^{n+1}\)</span> and rrhenius factor <span class="arithmatex">\(A(T^n)\)</span>,</li>
<li>compute the 2D basal frictional heat <span class="arithmatex">\(Q_{\rm fh}^n\)</span>, from basal velocity field <span class="arithmatex">\({\bf u}\)</span> and sliding coefficient <span class="arithmatex">\(c^n\)</span>,</li>
<li>compute the <span class="arithmatex">\(UPWIND^n\)</span> term for the explicit treatement of the horizontal advection,</li>
<li>compute the surface Enthalpy <span class="arithmatex">\(E^n_s\)</span> from the surface temperature <span class="arithmatex">\(T^n_s\)</span>,</li>
<li>compute the new enthalpy <span class="arithmatex">\(E^{n+1}\)</span> field solving one-dimension column-wise advection-diffusion equation, as well as the basal melt rate, <strong>this is the main updating step</strong>,</li>
<li>compute the water thickness in the till <span class="arithmatex">\(W^{n+1}\)</span>,</li>
<li>compute the sliding parametrization <span class="arithmatex">\(c^{n+1}\)</span>. </li>
</ul>
<h3 id="numerical-stability-time-stepping">Numerical stability -- time stepping</h3>
<p>Here one updates the enthalpy as many times as the ice flow, we assume that the time step for the explicit advection is more restrictive than the implicit diffusion-advection problem.</p>
<h3 id="dependencies">Dependencies</h3>
<ul>
<li>the enthalpy module builds upon the module iceflow</li>
<li>one needs to have the vertical_iceflow module activated to provide the vertical velocitiy</li>
<li>make sure to have params.dim_arrhenius = 3</li>
<li>make sure to have params.new_friction_param = true</li>
<li>make sure to ave enough retraining retrain_iceflow_emulator_freq: 1, possibly retrain_iceflow_emulator_nbit more than 1.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../clim_oggm/" class="md-footer__link md-footer__link--prev" aria-label="Previous: clim_oggm">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                clim_oggm
              </div>
            </div>
          </a>
        
        
          
          <a href="../gflex/" class="md-footer__link md-footer__link--next" aria-label="Next: gflex">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                gflex
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate", "content.code.select", "navigation.path", "navigation.instant.progress", "navigation.tabs", "navigation.footer", "toc.integrate", "toc.follow", "search.highlight", "search.suggest"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>